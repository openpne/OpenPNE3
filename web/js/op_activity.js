var opActivity=function(f,b){var c=this;var e=function(j,h,i,g){if(j.addEventListener){j.addEventListener(h,i,g)}else{if(j.attachEvent){h="on"+h;j.attachEvent(h,i)}}};var d=function(){var g=null;if(window.XMLHttpRequest){g=new XMLHttpRequest()}else{if(window.ActiveXObject){try{g=new ActiveXObject("Msxml2.XMLHTTP")}catch(h){g=new ActiveXObject("Microsoft.XMLHTTP")}}}return g};this.post=function(){var h=d();h.open("POST",b,true);h.setRequestHeader("X-Requested-With","XMLHttpRequest");h.setRequestHeader("Content-Type","application/x-www-form-urlencoded");var j="";for(var g=0;g<this.form.elements.length;g++){j+="&"+encodeURIComponent(this.form.elements[g].name)+"="+encodeURIComponent(this.form.elements[g].value)}j=j.length>1?j.substring(1):"";h.onreadystatechange=function(k){if(h.readyState==4&&h.status==200){if(0==h.responseText.indexOf("same-message")){var i=h.responseText.split("|")[1];alert(i)}else{c.timeline.innerHTML=h.responseText+c.timeline.innerHTML}}};h.send(j)};var a=function(g){c.form=document.getElementById(f+"_form");c.body=document.getElementById(f+"_activity_data_body");c.timeline=document.getElementById(f+"_timeline");c.body.onkeyup=function(){var h=this.value.length;document.getElementById(f+"_count").innerHTML=140-h};c.body.onkeyup();e(c.form,"submit",function(h){if(c.body.value&&c.body.value.length>0&&c.body.value.length<=140){c.post();c.body.value="";c.body.onkeyup()}if(h.preventDefault){h.preventDefault()}else{return false}},false)};e(window,"load",a,false)};